# OIDC middleware
---
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: waf
  namespace: whoami
spec:
  plugin:
    coraza:
      directives:
        - SecRuleEngine On
        - SecDebugLog /dev/stdout
        - SecDebugLogLevel 9
        - SecRule REQUEST_METHOD "^(?:GET)$" "id:102,phase:1,t:none,log,deny,msg:'GET request methods NOT allowed',logdata:%{REQUEST_METHOD}"
        # - SecRule REQUEST_URI "@streq ^(?:admin)$" "id:101,phase:1,log,deny,status:403"